@model ISpanShop.MVC.Models.ViewModels.ProductDetailVm

@{
    ViewData["Title"] = $"ÂïÜÂìÅË©≥ÊÉÖ - {Model?.Name ?? "Êú™Áü•"}";
}

<div class="container-lg py-5">
    <!-- È†ÅÈù¢Ê®ôÈ°å -->
    <div class="row mb-5">
        <div class="col-md-12">
            <div class="d-flex align-items-center justify-content-between">
                <div>
                    <h1 class="display-5 fw-bold mb-2">@Model.Name</h1>
                    <p class="text-muted fs-6">
                        <span class="badge bg-light text-dark">ÂïÜÂìÅ ID: @Model.Id</span>
                        <span class="ms-2 badge bg-@Model.StatusBadgeClass">@Model.StatusText</span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- ‰∏ªË¶ÅÂÖßÂÆπÂçÄ -->
    <div class="row g-4 mb-5">
        <!-- Â∑¶ÂÅ¥ÔºöÂúñÁâáËº™Êí≠ -->
        <div class="col-lg-6">
            <div class="card shadow-sm border-0 rounded-3 overflow-hidden mb-3">
                <div class="card-body p-0">
                    @if (Model.Images != null && Model.Images.Any())
                    {
                        <div id="productCarousel" class="carousel carousel-dark slide" data-bs-ride="carousel">
                            <!-- Indicators -->
                            @if (Model.Images.Count > 1)
                            {
                                <div class="carousel-indicators">
                                    @for (int i = 0; i < Model.Images.Count; i++)
                                    {
                                        <button type="button" data-bs-target="#productCarousel" data-bs-slide-to="@i" class="@(i == 0 ? "active" : "")" aria-current="@(i == 0 ? "true" : "false")" aria-label="Slide @(i + 1)"></button>
                                    }
                                </div>
                            }

                            <!-- Carousel Items -->
                            <div class="carousel-inner">
                                @for (int i = 0; i < Model.Images.Count; i++)
                                {
                                    <div class="carousel-item @(i == 0 ? "active" : "")">
                                        <img src="@Model.Images[i]" class="d-block w-100" alt="ÂïÜÂìÅÂúñÁâá @(i + 1)" style="width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 8px;">
                                    </div>
                                }
                            </div>

                            <!-- Controls -->
                            @if (Model.Images.Count > 1)
                            {
                                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">‰∏ä‰∏ÄÂºµ</span>
                                </button>
                                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">‰∏ã‰∏ÄÂºµ</span>
                                </button>
                            }
                        </div>
                    }
                    else
                    {
                        <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); height: 400px; display: flex; align-items: center; justify-content: center;">
                            <div class="text-center">
                                <i class="bi bi-image" style="font-size: 3rem; color: #adb5bd;"></i>
                                <p class="text-muted mt-3">ÁÑ°ÂúñÁâá</p>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- ÂúñÁâáÊ∏ÖÂñÆ -->
            @if (Model.Images != null && Model.Images.Count > 1)
            {
                <div class="d-flex flex-wrap gap-2 mb-5 pb-3">
                    @for (int i = 0; i < Model.Images.Count; i++)
                    {
                        <div class="flex-shrink-0">
                            <img src="@Model.Images[i]" class="img-thumbnail rounded-2" alt="Á∏ÆÂúñ @(i + 1)"
                                 style="object-fit: cover; height: 100px; width: 100px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease;"
                                 data-bs-target="#productCarousel"
                                 data-bs-slide-to="@i"
                                 onmouseover="this.style.borderColor='#0d6efd'; this.style.boxShadow='0 4px 8px rgba(13, 110, 253, 0.3)';"
                                 onmouseout="this.style.borderColor='transparent'; this.style.boxShadow='none';" />
                        </div>
                    }
                </div>
            }
        </div>

        <!-- Âè≥ÂÅ¥ÔºöÂïÜÂìÅÂü∫Êú¨Ë≥áË®ä -->
        <div class="col-lg-6">
            <div class="card shadow-sm border-0 rounded-3 mb-3">
                <div class="card-body">
                    <!-- ÂïÜÂìÅÂàÜÈ°ûËàáÂìÅÁâå -->
                    <div class="mb-4">
                        <div class="d-flex gap-2 flex-wrap">
                            @if (!string.IsNullOrEmpty(Model.CategoryName))
                            {
                                <span class="badge bg-primary">@Model.CategoryName</span>
                            }
                            @if (!string.IsNullOrEmpty(Model.BrandName))
                            {
                                <span class="badge bg-info">@Model.BrandName</span>
                            }
                        </div>
                    </div>

                    <!-- ÂïÜÂ∫óÂêçÁ®± -->
                    <div class="mb-4">
                        <h6 class="text-muted small mb-2">üè™ ÂïÜÂ∫ó</h6>
                        <p class="fs-6 fw-500">@Model.StoreName</p>
                    </div>

                    <hr class="my-4" />

                    <!-- ÂïÜÂìÅÊèèËø∞ -->
                    @if (!string.IsNullOrEmpty(Model.Description))
                    {
                        <div class="mb-4">
                            <h6 class="text-muted small mb-2">üìù ÂïÜÂìÅÊèèËø∞</h6>
                            <p class="text-dark">@Model.Description</p>
                        </div>
                    }

                    <!-- Áµ±Ë®àË≥áË®ä -->
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="p-3 bg-light rounded-2">
                                <h6 class="text-muted small mb-1">Ë¶èÊ†ºÊï∏Èáè</h6>
                                <p class="fs-5 fw-bold">@(Model.Variants?.Count ?? 0) ÂÄã</p>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-3 bg-light rounded-2">
                                <h6 class="text-muted small mb-1">ÂúñÁâáÊï∏Èáè</h6>
                                <p class="fs-5 fw-bold">@(Model.Images?.Count ?? 0) Âºµ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ë¶èÊ†ºË©≥ÊÉÖË°® -->
    <div class="row mb-5">
        <div class="col-md-12">
            <div class="card shadow-sm border-0 rounded-3">
                <div class="card-header bg-light border-0 rounded-top-3">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-list-check"></i> Ë¶èÊ†ºË©≥ÊÉÖ
                    </h5>
                </div>
                <div class="card-body">
                    @if (Model.Variants != null && Model.Variants.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 25%;">SKU ‰ª£Á¢º</th>
                                        <th style="width: 20%;">Ë¶èÊ†ºÂêçÁ®±</th>
                                        <th style="width: 15%;" class="text-end">ÂÉπÊ†º</th>
                                        <th style="width: 15%;" class="text-center">Â∫´Â≠ò</th>
                                        <th style="width: 25%;">Ë¶èÊ†ºÂÄº</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var variant in Model.Variants)
                                    {
                                        <tr class="border-bottom">
                                            <td>
                                                <code class="px-2 py-1 bg-light rounded">@variant.SkuCode</code>
                                            </td>
                                            <td>@variant.VariantName</td>
                                            <td class="text-end">
                                                <span class="fs-6 fw-bold text-success">@variant.Price.ToString("C0")</span>
                                            </td>
                                            <td class="text-center">
                                                @if (variant.Stock > 10)
                                                {
                                                    <span class="badge bg-success">@variant.Stock ‰ª∂</span>
                                                }
                                                else if (variant.Stock > 0)
                                                {
                                                    <span class="badge bg-warning text-dark">@variant.Stock ‰ª∂</span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-danger">Â∑≤Áº∫Ë≤®</span>
                                                }
                                            </td>
                                            <td>
                                                @if (!string.IsNullOrEmpty(variant.SpecValueJson) && variant.SpecValueJson != "{}")
                                                {
                                                    <small class="text-muted font-monospace">@variant.SpecValueJson</small>
                                                }
                                                else
                                                {
                                                    <span class="text-muted">‚Äî</span>
                                                }
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-warning mb-0" role="alert">
                            <i class="bi bi-exclamation-triangle"></i> Êö´ÁÑ°Ë¶èÊ†ºË≥áË®ä
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Êìç‰ΩúÊåâÈàï -->
    <div class="row">
        <div class="col-md-12">
            <div class="d-flex gap-2 justify-content-start">
                <a href="@Url.Action("Index")" class="btn btn-outline-secondary btn-lg">
                    <i class="bi bi-arrow-left"></i> ËøîÂõûÂàóË°®
                </a>
                <a href="@Url.Action("Edit", new { id = Model.Id })" class="btn btn-primary btn-lg">
                    <i class="bi bi-pencil-square"></i> Á∑®ËºØÂïÜÂìÅ
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    /* ÂÖ®Â±ÄÂç°ÁâáÊ®£Âºè */
    .card {
        border: none;
        transition: all 0.3s ease;
    }

    .card:hover {
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1) !important;
    }

    /* ÂúìËßíÂç°Áâá */
    .rounded-3 {
        border-radius: 1rem !important;
    }

    /* Ëº™Êí≠ÂúñÊ®£Âºè */
    .carousel-dark .carousel-control-prev-icon,
    .carousel-dark .carousel-control-next-icon {
        filter: invert(1) grayscale(100%) brightness(1.2);
    }

    /* ‰ª£Á¢ºÂ°äÊ®£Âºè */
    code {
        background-color: #f5f5f5;
        color: #d63384;
        font-family: 'Monaco', 'Courier New', monospace;
        font-size: 0.875rem;
    }

    /* Badge Ê®£Âºè */
    .badge {
        padding: 0.5rem 0.75rem;
        font-weight: 500;
        letter-spacing: 0.5px;
    }

    /* Ë°®Ê†ºË°åÊá∏ÂÅúÊïàÊûú */
    .table-hover tbody tr:hover {
        background-color: rgba(13, 110, 253, 0.05) !important;
    }

    /* ÊåâÈàïÊ®£Âºè */
    .btn-outline-secondary {
        border-width: 2px;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .btn-outline-secondary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .btn-primary {
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);
    }

    /* Ê®ôÈ°åÊ®£Âºè */
    .display-5 {
        font-weight: 700;
        color: #1a1a1a;
    }

    /* Áµ±Ë®àÁõíÊ®£Âºè */
    .bg-light {
        background-color: #f8f9fa !important;
    }

    /* Â™íÈ´îÊü•Ë©¢ - ÁßªÂãïÁ´Ø */
    @@media (max-width: 991.98px) {
        .container-lg {
            padding: 1rem;
        }

        .display-5 {
            font-size: 2rem;
        }

        .btn-lg {
            font-size: 0.95rem;
            padding: 0.5rem 1rem;
        }
    }
</style>
